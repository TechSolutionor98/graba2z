<!DOCTYPE html>
<html lang="en" class="">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title -->
    <title> Graba2z- E-commerce website</title>
    <!-- Favicon -->
    <link rel="shortcut icon" href="assets/images/logo/favicon.png">
    <link rel="stylesheet" href="assets/css/footer.css" />

    <!-- Bootstrap -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <!-- select 2 -->
    <link rel="stylesheet" href="assets/css/select2.min.css">
    <!-- Slick -->
    <link rel="stylesheet" href="assets/css/slick.css">
    <!-- Jquery Ui -->
    <link rel="stylesheet" href="assets/css/jquery-ui.css">
    <!-- animate -->
    <link rel="stylesheet" href="assets/css/animate.css">
    <!-- AOS Animation -->
    <link rel="stylesheet" href="assets/css/aos.css">
    <!-- Main css -->
    <link rel="stylesheet" href="assets/css/main.css">
</head> 
<body>
    
<!--==================== Preloader Start ====================-->
  <!-- <div class="preloader">
    <img src="assets/images/icon/preloader.gif" alt="">
  </div> -->
<!--==================== Preloader End ====================-->

<!--==================== Overlay Start ====================-->
<div class="overlay"></div>
<!--==================== Overlay End ====================-->

<!--==================== Sidebar Overlay End ====================-->
<div class="side-overlay"></div>
<!--==================== Sidebar Overlay End ====================-->

<!-- ==================== Scroll to Top End Here ==================== -->
<div class="progress-wrap">
  <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
      <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98" />
  </svg>
</div>
<!-- ==================== Scroll to Top End Here ==================== -->


<div id="header"></div>
    <!-- ========================= Breadcrumb Start =============================== -->
<div class="breadcrumb py-26 bg-main-two-50">
    <div class="container container-lg">
        <div class="breadcrumb-wrapper flex-between flex-wrap gap-16">
            <h6 class="mb-0">Checkout</h6>
            <ul class="flex-align gap-8 flex-wrap">
                <li class="text-sm">
                    <a href="index.html" class="text-gray-900 flex-align gap-8 hover-text-main-600">
                        <i class="ph ph-house"></i>
                        Home
                    </a>
                </li>
                <li class="flex-align">
                    <i class="ph ph-caret-right"></i>
                </li>
                <li class="text-sm text-main-600"> Checkout </li>
            </ul>
        </div>
    </div>
</div>
<!-- ========================= Breadcrumb End =============================== -->

    <!-- ================================= Checkout Page Start ===================================== -->
    <section class="checkout py-80">
        <div class="container container-lg">
            <div class="row gy-4">
                <!-- Left Inputs Section -->
                <div class="col-xl-9 col-lg-8">
                    <form action="#" class="pe-xl-5">
                        <div class="row gy-3">
                            <div class="col-sm-6">
                                <input id="first-name" type="text" class="common-input border-gray-100" placeholder="First Name">
                            </div>
                            <div class="col-sm-6">
                                <input id="last-name" type="text" class="common-input border-gray-100" placeholder="Last Name">
                            </div>
                            <div class="col-12">
                                <input id="country" type="text" class="common-input border-gray-100" placeholder="United States (US)">
                            </div>
                            <div class="col-12">
                                <input id="street-name" type="text" class="common-input border-gray-100" placeholder="House number and street name">
                            </div>
                            <div class="col-12">
                                <input id="apartment-name" type="text" class="common-input border-gray-100" placeholder="Apartment, suite, unit, etc. (Optional)">
                            </div>
                            <div class="col-12">
                                <input id="city-name" type="text" class="common-input border-gray-100" placeholder="City">
                            </div>
                            <div class="col-12">
                                <input id="state-name" type="text" class="common-input border-gray-100" placeholder="State">
                            </div>
                            <div class="col-12">
                                <input id="post-code" type="text" class="common-input border-gray-100" placeholder="Post Code">
                            </div>
                            <div class="col-12">
                                <input id="phone-number" type="number" class="common-input border-gray-100" placeholder="Phone">
                            </div>
                            <div class="col-12">
                                <input id="email-address" type="email" class="common-input border-gray-100" placeholder="Email Address">
                            </div>
                            <div class="col-12">
                                <div class="my-40">
                                    <h6 class="text-lg mb-24">Additional Information</h6>
                                    <input id="order-notes" type="text" class="common-input border-gray-100" placeholder="Notes about your order, e.g. special notes for delivery.">
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
    
                <!-- Right Order Summary Section -->
                <div class="col-xl-3 col-lg-4">
                    <div class="checkout-sidebar">
                        <div class="bg-color-three rounded-8 p-24 text-center">
                            <span class="text-gray-900 text-xl fw-semibold">Your Orders</span>
                        </div>
                        <div id="checkout-order-container" class="border border-gray-100 rounded-8 px-24 py-40 mt-24">
                            <!-- Dynamic Cart Content Will Be Loaded Here -->
                        </div>
                          <!-- Payment Methods -->
                    <div class="mt-32">
                        <h6 class="text-lg mb-16">Payment Method</h6>
                        <div class="payment-item">
                            <div class="form-check common-check common-radio py-16 mb-0">
                                <input class="form-check-input" type="radio" name="payment" id="cash-on-delivery">
                                <label class="form-check-label fw-semibold text-neutral-600" for="cash-on-delivery">Cash on Delivery</label>
                            </div>
                        </div>
                    </div>
                    
                        <div class="mt-32 pt-32 border-top border-gray-100">
                            <p class="text-gray-500">
                                Your personal data will be used to process your order, support your experience throughout this website, and for other purposes described in our 
                                <a href="#" class="text-main-600 text-decoration-underline">privacy policy</a>.
                            </p>
                        </div>
                        <a id="place-order-button" href="javascript:void(0)" class="btn btn-main mt-40 py-18 w-100 rounded-8">Place Order</a>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
<!-- ================================= Checkout Page End ===================================== -->

    <!-- ========================== Shipping Section Start ============================ -->
 <section class="shipping mb-24" id="shipping">
    <div class="container container-lg">
        <div class="row gy-4">
            <div class="col-xxl-3 col-sm-6" data-aos="zoom-in" data-aos-duration="400">
                <div class="shipping-item flex-align gap-16 rounded-16 bg-main-50 hover-bg-main-100 transition-2">
                    <span class="w-56 h-56 flex-center rounded-circle bg-main-600 text-white text-32 flex-shrink-0"><i class="ph-fill ph-car-profile"></i></span>
                    <div class="">
                        <h6 class="mb-0">Free Shipping</h6>
                        <span class="text-sm text-heading">Free shipping all over the US</span>
                    </div>
                </div>
            </div>
            <div class="col-xxl-3 col-sm-6" data-aos="zoom-in" data-aos-duration="600">
                <div class="shipping-item flex-align gap-16 rounded-16 bg-main-50 hover-bg-main-100 transition-2">
                    <span class="w-56 h-56 flex-center rounded-circle bg-main-600 text-white text-32 flex-shrink-0"><i class="ph-fill ph-hand-heart"></i></span>
                    <div class="">
                        <h6 class="mb-0"> 100% Satisfaction</h6>
                        <span class="text-sm text-heading">Free shipping all over the US</span>
                    </div>
                </div>
            </div>
            <div class="col-xxl-3 col-sm-6" data-aos="zoom-in" data-aos-duration="800">
                <div class="shipping-item flex-align gap-16 rounded-16 bg-main-50 hover-bg-main-100 transition-2">
                    <span class="w-56 h-56 flex-center rounded-circle bg-main-600 text-white text-32 flex-shrink-0"><i class="ph-fill ph-credit-card"></i></span>
                    <div class="">
                        <h6 class="mb-0"> Secure Payments</h6>
                        <span class="text-sm text-heading">Free shipping all over the US</span>
                    </div>
                </div>
            </div>
            <div class="col-xxl-3 col-sm-6" data-aos="zoom-in" data-aos-duration="1000">
                <div class="shipping-item flex-align gap-16 rounded-16 bg-main-50 hover-bg-main-100 transition-2">
                    <span class="w-56 h-56 flex-center rounded-circle bg-main-600 text-white text-32 flex-shrink-0"><i class="ph-fill ph-chats"></i></span>
                    <div class="">
                        <h6 class="mb-0"> 24/7 Support</h6>
                        <span class="text-sm text-heading">Free shipping all over the US</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
 </section>
<!-- ========================== Shipping Section End ============================ -->
    


<div id="footer"></div>

<script>
    // Fetch the footer dynamically
    fetch('../includes/footer.html') // Go one level up and access includes/
        .then(response => response.text())
        .then(data => {
            document.getElementById('footer').innerHTML = data;
        })
        .catch(error => console.error('Error loading footer:', error));
</script>

<script>
    // Fetch the header dynamically
    fetch('../includes/header.html') // Go one level up and access includes/
        .then(response => response.text())
        .then(data => {
            document.getElementById('header').innerHTML = data;
        })
        .catch(error => console.error('Error loading header:', error));
</script>

<!-- ==================== Footer End Here ==================== -->
    
    <!-- Jquery js -->
    <script src="assets/js/jquery-3.7.1.min.js"></script>
    <!-- Bootstrap Bundle Js -->
    <script src="assets/js/boostrap.bundle.min.js"></script>
    <!-- Bootstrap Bundle Js -->
    <script src="assets/js/phosphor-icon.js"></script>
    <!-- Select 2 -->
    <script src="assets/js/select2.min.js"></script>
    <!-- Slick js -->
    <script src="assets/js/slick.min.js"></script>
    <!-- Slick js -->
    <script src="assets/js/count-down.js"></script>
    <!-- jquery UI js -->
    <script src="assets/js/jquery-ui.js"></script>
    <!-- wow js -->
    <script src="assets/js/wow.min.js"></script>
    <!-- AOS Animation -->
    <script src="assets/js/aos.js"></script>
    <!-- marque -->
    <script src="assets/js/marque.min.js"></script>
    <!-- marque -->
    <script src="assets/js/vanilla-tilt.min.js"></script>
    <!-- main js -->
    <script src="assets/js/main.js"></script>

    <script>

document.getElementById('search-form').addEventListener('submit', (event) => {
    event.preventDefault();
    const searchQuery = document.getElementById('search-input').value.trim();
    window.location.href = `shop.html?search=${encodeURIComponent(searchQuery)}`;
    // await fetchFilteredProducts(searchQuery);
});
        // document.addEventListener('DOMContentLoaded', () => {
        //     // Load cart details into the checkout page
        //     loadCheckoutCart();
        // });
    
        // function loadCheckoutCart() {
        //     const cart = JSON.parse(localStorage.getItem('cart')) || [];
        //     const orderContainer = document.getElementById('checkout-order-container');
    
        //     if (!cart.length) {
        //         orderContainer.innerHTML = `
        //             <div class="text-center py-40">
        //                 <p>Your cart is empty. <a href="cart.html" class="text-main-600">Go back to cart</a></p>
        //             </div>`;
        //         return;
        //     }
    
        //     // Prepare the cart summary dynamically
        //     let subtotal = 0;
        //     let cartHTML = `
        //         <div class="mb-32 pb-32 border-bottom border-gray-100 flex-between gap-8">
        //             <span class="text-gray-900 fw-medium text-xl font-heading-two">Product</span>
        //             <span class="text-gray-900 fw-medium text-xl font-heading-two">Subtotal</span>
        //         </div>`;
    
        //     cart.forEach(product => {
        //         const price = parseFloat(product.selling_price || 0);
        //         const itemSubtotal = price * product.quantity;
        //         subtotal += itemSubtotal;
    
        //         cartHTML += `
        //             <div class="flex-between gap-24 mb-32">
        //                 <div class="flex-align gap-12">
        //                     <span class="text-gray-900 fw-normal text-md font-heading-two w-144">${product.name}</span>
        //                     <span class="text-gray-900 fw-normal text-md font-heading-two"><i class="ph-bold ph-x"></i></span>
        //                     <span class="text-gray-900 fw-semibold text-md font-heading-two">${product.quantity}</span>
        //                 </div>
        //                 <span class="text-gray-900 fw-bold text-md font-heading-two">$${itemSubtotal.toFixed(2)}</span>
        //             </div>`;
        //     });
    
        //     const taxes = parseFloat((subtotal * 0.1).toFixed(2)); // Assuming 10% tax
        //     const total = (subtotal + taxes).toFixed(2);
    
        //     cartHTML += `
        //         <div class="border-top border-gray-100 pt-30 mt-30">
        //             <div class="mb-32 flex-between gap-8">
        //                 <span class="text-gray-900 font-heading-two text-xl fw-semibold">Subtotal</span>
        //                 <span class="text-gray-900 font-heading-two text-md fw-bold">$${subtotal.toFixed(2)}</span>
        //             </div>
        //             <div class="mb-0 flex-between gap-8">
        //                 <span class="text-gray-900 font-heading-two text-xl fw-semibold">Total</span>
        //                 <span class="text-gray-900 font-heading-two text-md fw-bold">$${total}</span>
        //             </div>
        //         </div>`;
    
        //     orderContainer.innerHTML = cartHTML;
        // }
    
        // // Place Order Button Functionality
        // document.getElementById('place-order-button').addEventListener('click', () => {
        //     const cart = JSON.parse(localStorage.getItem('cart')) || [];
        //     if (cart.length === 0) {
        //         alert('Your cart is empty!');
        //         return;
        //     }
    
        //     // Collect order details (e.g., user information)
        //     const userDetails = {
        //         firstName: document.getElementById('first-name').value.trim(),
        //         lastName: document.getElementById('last-name').value.trim(),
        //         country: document.getElementById('country').value.trim(),
        //         street: document.getElementById('street-name').value.trim(),
        //         apartment: document.getElementById('apartment-name').value.trim(),
        //         city: document.getElementById('city-name').value.trim(),
        //         state: document.getElementById('state-name').value.trim(),
        //         postCode: document.getElementById('post-code').value.trim(),
        //         phone: document.getElementById('phone-number').value.trim(),
        //         email: document.getElementById('email-address').value.trim(),
        //         notes: document.getElementById('order-notes').value.trim(),
        //     };
    
        //     // Validate required fields
        //     if (!userDetails.firstName || !userDetails.lastName || !userDetails.street || !userDetails.city || !userDetails.state || !userDetails.postCode || !userDetails.phone || !userDetails.email) {
        //         alert('Please fill in all required fields!');
        //         return;
        //     }
    
        //     // Mock order submission
        //     console.log('Order Placed:', { cart, userDetails });
    
        //     // Clear the cart and redirect to a confirmation page
        //     localStorage.removeItem('cart');
        //     alert('Order placed successfully!');
        //     window.location.href = 'confirmation.html';
        // });
        document.addEventListener('DOMContentLoaded', () => {
    // Load cart details into the checkout page
    loadCheckoutCart();

    // Set up Place Order button functionality
    document.getElementById('place-order-button').addEventListener('click', placeOrder);
});

// Function to load the cart details into the checkout page
function loadCheckoutCart() {
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    const orderContainer = document.getElementById('checkout-order-container');

    if (!cart.length) {
        orderContainer.innerHTML = `
            <div class="text-center py-40">
                <p>Your cart is empty. <a href="cart.html" class="text-main-600">Go back to cart</a></p>
            </div>`;
        return;
    }

    // Prepare the cart summary dynamically
    let subtotal = 0;
    let cartHTML = `
        <div class="mb-32 pb-32 border-bottom border-gray-100 flex-between gap-8">
            <span class="text-gray-900 fw-medium text-xl font-heading-two">Product</span>
            <span class="text-gray-900 fw-medium text-xl font-heading-two">Subtotal</span>
        </div>`;

    cart.forEach(product => {
        const price = parseFloat(product.selling_price || 0);
        const itemSubtotal = price * product.quantity;
        subtotal += itemSubtotal;

        cartHTML += `
            <div class="flex-between gap-24 mb-32">
                <div class="flex-align gap-12">
                    <span class="text-gray-900 fw-normal text-md font-heading-two w-144">${product.name}</span>
                    <span class="text-gray-900 fw-normal text-md font-heading-two"><i class="ph-bold ph-x"></i></span>
                    <span class="text-gray-900 fw-semibold text-md font-heading-two">${product.quantity}</span>
                </div>
                <span class="text-gray-900 fw-bold text-md font-heading-two">$${itemSubtotal.toFixed(2)}</span>
            </div>`;
    });

    const taxes = parseFloat((subtotal * 0.1).toFixed(2)); // Assuming 10% tax
    const total = (subtotal + taxes).toFixed(2);

    cartHTML += `
        <div class="border-top border-gray-100 pt-30 mt-30">
            <div class="mb-32 flex-between gap-8">
                <span class="text-gray-900 font-heading-two text-xl fw-semibold">Subtotal</span>
                <span class="text-gray-900 font-heading-two text-md fw-bold">$${subtotal.toFixed(2)}</span>
            </div>
            <div class="mb-0 flex-between gap-8">
                <span class="text-gray-900 font-heading-two text-xl fw-semibold">Total</span>
                <span class="text-gray-900 font-heading-two text-md fw-bold">$${total}</span>
            </div>
        </div>`;

    orderContainer.innerHTML = cartHTML;
}

// Function to handle placing an order
async function placeOrder() {
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    if (cart.length === 0) {
        alert('Your cart is empty!');
        return;
    }

    // Collect order details
    const customerDetails = {
        firstName: document.getElementById('first-name').value.trim(),
        lastName: document.getElementById('last-name').value.trim(),
        country: document.getElementById('country').value.trim(),
        street: document.getElementById('street-name').value.trim(),
        apartment: document.getElementById('apartment-name').value.trim(),
        city: document.getElementById('city-name').value.trim(),
        state: document.getElementById('state-name').value.trim(),
        postCode: document.getElementById('post-code').value.trim(),
        phone: document.getElementById('phone-number').value.trim(),
        email: document.getElementById('email-address').value.trim(),
        notes: document.getElementById('order-notes').value.trim(),
    };

    // Validate required fields
    if (!customerDetails.firstName || !customerDetails.lastName || !customerDetails.street || 
        !customerDetails.city || !customerDetails.state || !customerDetails.postCode || 
        !customerDetails.phone || !customerDetails.email) {
        alert('Please fill in all required fields!');
        return;
    }

    // Calculate total amount
    const totalAmount = cart.reduce((sum, item) => sum + item.selling_price * item.quantity, 0);

    try {
        // Send order data to the server
        const response = await fetch('http://localhost:5000/api/orders', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                cart, // Cart details
                customerDetails, // Customer details
                totalAmount, // Add total amount
            }),
        });

        const result = await response.json();

        if (response.ok) {
            // Clear the cart and redirect to a confirmation page
            localStorage.removeItem('cart');
            alert('Order placed successfully!');
            window.location.href = 'confirmation.html';
        } else {
            console.error('Error placing order:', result);
            alert(`Failed to place order: ${result.message}`);
        }
    } catch (err) {
        console.error('Error placing order:', err);
        alert('An error occurred while placing the order. Please try again.');
    }
}

    </script>
    

    </body>
</html>